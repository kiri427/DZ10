Описание уязвимости:
CVE-2019-5418 — уязвимость в Ruby on Rails (версии до 6.0.2), позволяющая злоумышленнику читать произвольные файлы на сервере. Проблема связана с некорректной обработкой заголовка Accept в механизме рендеринга файлов. Атакующий может отправить специально сформированный запрос, содержащий обход пути (path traversal), и получить содержимое системных файлов (например, /etc/passwd).


Скрипт формирует HTTP-запрос с заголовком Accept, содержащим path traversal-последовательность (../../../../../../etc/passwd{{). Если сервер уязвим, он вернёт содержимое запрошенного файла. Скрипт проверяет наличие строки root: в ответе как индикатор успеха. В реальных условиях тестирование следует проводить только на собственных или специально подготовленных стендах.

